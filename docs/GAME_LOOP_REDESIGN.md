# RL Dungeon — 게임 리디자인 문서

## 한 줄 요약

> **멍청한 세르파 파티를 이끌고 던전을 답파하는 로그라이크.**
> 목숨이 아까운 모험가 대신 몸빵으로 길을 찾는 놈들. 완벽한 녀석은 없다.

---

## 1. 세계관

당신은 세르파 파티의 파티장이다.
세르파 — 좋게 말해서 세르파. 실체는 **모험가들 대신 몸빵으로 던전 길을 찾는 놈들.**

목숨이 아까운 모험가들은 직접 미지의 던전에 들어가지 않는다.
대신 세르파들을 보내 길을 찾게 하고, 안전한 지도가 나오면 그때 들어간다.

세르파들은 특별하지 않다. 강하지도, 똑똑하지도 않다.
몬스터를 만나면 그냥 맞고, 함정을 밟으면 그냥 당하고, 죽으면 그만이다.
**그래도 죽을 때마다 뭔가를 배운다.** 그게 이 놈들의 유일한 장점.

Q는 길을 외우려 하지만 함정 앞에서도 직진하고,
사르사는 겁이 많아서 한번 아팠던 길은 절대 안 가고,
다이나는 머릿속 시뮬레이션만 돌리다 현실에서 멍하고,
몬테는 일단 끝까지 가봐야 직성이 풀린다.

성장 같은 건 없다. OP가 될 수도 없다. 할 수 있는 건 **길찾기와 개싸움** 뿐.
지도 팔고, 길 안내하고, 부하들 부활비 마련하면서 근근이 먹고 사는 암울한 파티.

그렇게 던전 하나하나 답파하다가... 마지막 던전의 코어에 도달하면,
코어가 당신을 선택한다. **당신이 던전 마스터가 된다.**

---

## 2. 게임 구조 (3막)

```
━━━ Act 1: 던전 정복 (솔로, 로그라이크) ━━━━━━━━━━━━━━━

  세르파 파티로 던전 31개 답파
  파티장 사망 = 리셋 (세르파 학습만 계승)
  전 던전 클리어 → 엔딩 (던전 마스터 각성)

━━━ Act 2: 던전 마스터 (솔로, 공방전) ━━━━━━━━━━━━━━━

  던전 에디터 해금 — 내 던전을 설계하고 방어
  AI 던전 마스터가 세르파를 보내 침공
  동시에 적 던전도 공략 — 공격 vs 방어 자원 분배
  타임 어택: 적이 내 던전 뚫기 전에 적 던전 먼저 클리어

━━━ Act 3: PvP (온라인, 미래) ━━━━━━━━━━━━━━━━━━━━━━

  다른 유저와 공방전
  Act 2에서 익힌 감각 활용
```

### Act 1이 이 문서의 핵심. Act 2, 3은 Act 1 완성 후 확장.

---

## 3. Act 1: 코어 루프

```
[모험가 길드에서 다음 던전 의뢰 수령]
              ↓
    [정보 구매 (선택)] ← 단편적 힌트
              ↓
    [파티장 직접 탐사] or [세르파 파견 (운영비)]
              ↓
        [던전 클리어] → 최단 경로 기록
              ↓
    [지도 판매 or 보유] + [세르파 파밍 배치]
              ↓
    [수입 → 세르파 고용/강화]
              ↓
    [길드로 복귀 → 다음 의뢰]
```

---

## 4. 던전 의뢰 & 정보 시스템

### 4.1 의뢰 방식

모험가 길드에 가면 다음 던전을 알려준다. 단순하게.

```
모험가 길드:
  "다음 의뢰입니다."
  "던전: 독의 숲 (Lv.4)"
  "선발대가 필요합니다."

  [의뢰 수락]
```

야생 던전 "발견" 같은 건 없다. 길드가 순서대로 의뢰를 준다.

### 4.2 정보 구매

길드에서 던전에 대한 **단편적 정보**를 살 수 있다. 전체 지도를 주는 게 아니라 힌트.

**초반 던전 (Lv.1~5)**: 저렴하고 구체적
```
  [50G] "5×5 크기의 작은 미로입니다."
  [100G] "지도" → 전체 맵 공개
```

**중반 던전 (Lv.6~20)**: 단편적 정보만, 비쌈
```
  [100G] "식량 200으로는 끝까지 못 갔다더군요."
  [150G] "HP 30 이상 깎는 몬스터가 출몰합니다."
  [200G] "신중한 녀석을 데려가는 게 좋을 겁니다." → 사르사 힌트
  [300G] "부분 지도" → 입구 근처 50%만 공개
```

**후반 던전 (Lv.21~31)**: 매우 단편적, 매우 비쌈
```
  [300G] "50×50... 거대합니다. 그게 다입니다."
  [500G] "상상력이 풍부한 녀석이 유리할 겁니다." → 다이나 힌트
  [500G] "전임자의 메모 조각" → 랜덤 영역 10% 공개
```

### 4.3 정보 종류

| 정보 유형 | 예시 | 게임적 기능 |
|----------|------|-----------|
| 크기/난이도 | "15×15 규모" | 식량 적재량 판단 |
| 위험 경고 | "HP 30 데미지 몬스터" | 세르파 체력 판단 |
| 식량 힌트 | "300으로 부족했다" | 근력 업그레이드 판단 |
| 알고리즘 힌트 | "신중한 녀석이 유리" | 세르파 선택 가이드 |
| 부분 지도 | 입구 주변 일부 공개 | 안개 부분 해제 |
| 일회용 계약 용병 | "방어력 부스트 1회" | 해당 에피소드 피해 감소 |
| 트랩 무효 용병 | "함정 해제사 계약" | 해당 에피소드 함정 무시 |

---

## 5. 파티장 (플레이어)

파티장 = 플레이어 본인. 세르파들의 우두머리.

| 항목 | 설명 |
|------|------|
| 역할 | 정찰, 전략 지시, 직접 탐사 |
| 전투 | **몬스터에게 그냥 맞음** (HP 감소) |
| 함정 | **그냥 밟음** (HP 감소) |
| 사망 시 | **게임 오버 → 런 리셋** |

파티장도 세르파와 마찬가지로 특별한 전투력은 없다.
몬스터를 만나면 피가 깎이고, 함정을 밟으면 피가 깎이고, 피가 0이면 죽는다.

### 파티장이 직접 가는 이유
- **싸다**: 세르파 학습 비용 없이 식량만
- **지도 작성**: 걸어다닌 칸이 길드 지도에 기록
- **시범 데이터**: 파티장의 경로가 세르파 학습 자료가 됨

### 파티장이 직접 가면 안 되는 이유
- **죽으면 끝**: 게임 오버
- **대형 던전**: 50×50을 수동으로? 비현실적

자연스러운 흐름:
- 초반: "이 정도는 내가 직접 가지" → 돈 절약
- 중반: "위험한데... 세르파 보낼까?" → 비용 vs 안전
- 후반: "내가 가면 죽는다" → 세르파 필수

### 던전 포털 & 식량 (파티장 전용)

파티장이 직접 탐사할 때만 식량 시스템이 적용된다. (세르파는 운영비로 퉁침 — 섹션 7 참고)

| 항목 | 설명 |
|------|------|
| 식량 구매 | 원하는 만큼 (1G/개) |
| 식량 소모 | 1스텝 = 1식량 |
| 남은 식량 | 귀환해도 전량 소진 (환불 없음) |
| **출구 포털** | 출구 도달 시 포털로 즉시 귀환 — **편도 식량만 필요** |
| 입구 귀환 | 입구까지 걸어서 돌아감 — **왕복 식량 필요** |
| 식량 고갈 | 귀환 실패 → **사망 → 게임 오버** |
| 긴급 탈출 | 아이템/용병으로 즉시 귀환 (보험) |

```
전진 (출구 방향): 식량 줄어도 포털 닿으면 안전
후퇴 (입구 방향): 온 만큼 돌아가야 해서 식량 부담
→ 깊이 갈수록 귀환 어려움, 긴급 탈출 아이템의 가치 ↑
```

---

## 6. 세르파 시스템

### 6.1 세르파 = 멍청한 AI

세르파는 각각 다른 방식으로 길을 찾는다 (= 다른 RL 알고리즘).
강하지도 똑똑하지도 않다. 처음에 랜덤으로 헤매는 건 **멍청하니까 당연한 것.**
"정예 세르파가 왜 헤매지?"가 아니라 "멍청이가 죽어가면서 길을 배우는 것."

몬스터를 만나면 그냥 맞고 (HP 감소), 함정을 밟으면 그냥 당한다 (HP 감소).
전투 시스템 같은 건 없다. 그냥 피해를 입는다.

### 6.2 세르파 목록 & 고용 비용

| 등급 | 세르파 | 알고리즘 | 고용비 | 성격 |
|:----:|--------|---------|:------:|------|
| 무료 | Q군 | Q-Learning | 무료 | 낙관적 멍청이. 좌표를 외우려 함 |
| 무료 | 사르사 | SARSA | 무료 | 겁쟁이. 한번 아팠으면 그 길 안 감 |
| 무료 | 몬테 | Monte Carlo | 무료 | 고집쟁이. 끝까지 가봐야 판단 |
| 숙련 | 트레이서 | SARSA(λ) | 600G | 흔적 추적자. 발자취로 역추적 |
| 숙련 | 다이나 | Dyna-Q | 600G | 공상가. 현실보다 상상이 빠름 |
| 일반 | 그래디 | REINFORCE | 200G | 감으로 찍는 싸구려. 가끔 기적, 보통 헤맴 |
| 정예 | 크리틱 | Actor-Critic | 1,000G | 잔소리꾼. 행동하면서 비평 |
| ~~미등장~~ | ~~스카우트~~ | ~~Local Q-Learning~~ | — | Act 1 미등장 (논문 출처 없음, 코드만 보존) |
| 정예 | QV군 | QV-Learning | 1,000G | 이중인격. 두 가지로 평가 |
| 정예 | 아클라 | ACLA | 1,000G | 변덕쟁이. 확률을 직접 바꿈 |
| 정예 | 에크사 | Expected SARSA | 1,000G | 계산기. 기대값으로 판단 |
| 정예 | 더블Q | Double Q-Learning | 1,000G | 의심쟁이. 항상 두 번 확인 |
| 전설 | 앙상블 | Ensemble (BM) | 2,000G | 합의체. 5명이 투표해서 결정 |
| 전설 | 트리백 | n-step Tree Backup | 2,000G | 선견자. 미래를 내다봄 |
| 전설 | 스위퍼 | Prioritized Sweeping | 2,000G | 효율주의자. 중요한 것부터 |

### 6.3 스탯 & 업그레이드

**진짜 성장은 Q-table (학습 데이터).** 스탯은 보조일 뿐.
업그레이드는 최대 2회 (Lv.1 → Lv.2 → Lv.3=MAX). 금방 피크.
스탯은 런마다 리셋되므로 "이번 런에서 누구를 강화할까?"가 전략.

#### 스탯 종류

| 스탯 | 효과 | 올릴 수 있는 세르파 |
|------|------|-------------------|
| **근력** | 식량 적재량 (= maxSteps) ↑ | 전원 (기본) |
| **체력** | HP ↑ | 생존형 세르파만 |
| **민첩** | 자동 학습/파밍 속도 ↑ | 속도형 세르파만 |
| **시야** | 안개 시야 범위 ↑ | ~~스카우트만 (미등장)~~ |

#### 전체 성장표

근력은 전원 올라감 (증가량이 다름). 보조 특성은 해당 세르파만.

| 세르파 | 근력 증가/Lv | 보조 특성 | 강화 비용 | 성격 |
|--------|:-----------:|----------|:---------:|------|
| **Q군** | +30 | 없음 | 100G/Lv | 근력만 오르는 단순한 놈 |
| **그래디** | +20 | 없음 | 80G/Lv | 싸구려. 근력도 적게 오름 |
| **사르사** | +20 | 체력 +10/Lv | 150G/Lv | 오래 버팀 |
| **몬테** | +40 | 체력 +5/Lv | 150G/Lv | 식량 왕. 체력도 조금 |
| **트레이서** | +20 | 체력 +5/Lv | 150G/Lv | 꾸준히 버팀 |
| **다이나** | +10 | 민첩 +1단계/Lv | 200G/Lv | 약골이지만 빠름 |
| **크리틱** | +15 | 민첩 +1단계/Lv | 200G/Lv | 안정적이고 빠름 |
| **아클라** | +15 | 민첩 +1단계/Lv | 200G/Lv | 빠른 적응 |
| **트리백** | +25 | 민첩 +1단계/Lv | 250G/Lv | 넓은 탐색, 빠른 학습 |
| **스위퍼** | +15 | 민첩 +1단계/Lv | 250G/Lv | 속도 특화 |
| ~~스카우트~~ | — | — | — | Act 1 미등장 |
| **에크사** | +20 | 체력 +10/Lv | 200G/Lv | 안정적 생존 |
| **더블Q** | +20 | 체력 +10/Lv | 200G/Lv | 신중, 오래 버팀 |
| **QV군** | +15 | 체력 +5/Lv | 200G/Lv | 안정적 |
| **앙상블** | +30 | 체력 +5/Lv | 300G/Lv | 무겁고 강건 |

#### 예시: Q군 성장

```
Lv.1 (기본):  근력 100 (= 식량 100)
Lv.2 (100G):  근력 130 (= 식량 130)
Lv.3 (100G):  근력 160 (= 식량 160) ← MAX. 이게 끝.
```

#### 예시: 다이나 성장

```
Lv.1 (기본):  근력 60,  민첩 ×1.0
Lv.2 (200G):  근력 70,  민첩 ×1.5
Lv.3 (200G):  근력 80,  민첩 ×2.0  ← MAX
```

#### 패턴 요약

| 타입 | 보조 특성 | 해당 세르파 |
|------|----------|-----------|
| 근력만 | 없음 | Q군, 그래디 |
| 생존형 | +체력 | 사르사, 몬테, 트레이서, 에크사, 더블Q, QV군, 앙상블 |
| 속도형 | +민첩 | 다이나, 크리틱, 아클라, 트리백, 스위퍼 |
| ~~관찰형~~ | ~~+시야~~ | ~~스카우트 (미등장)~~ |

### 6.4 사망 & 비용

| 대상 | 사망 시 | 비고 |
|------|--------|------|
| **파티장** | **게임 오버 → 런 리셋** | 식량 고갈 or HP 0 |
| **세르파** | 운영비에 포함 (별도 비용 없음) | 에피소드 실패 = 학습 과정 |
| **학습(Q-table)** | **항상 보존** | 죽어도, 런 리셋해도 남음 |

세르파는 에피소드 실패(사망)가 곧 학습이다. 운영비가 이미 모든 비용을 포함하므로 별도 부활 시스템 없음.

---

## 7. 비용 시스템

세르파(AI)와 파티장(수동)은 **비용 구조가 완전히 다르다.**
AI 학습이 이미 충분한 허들이므로, 경제 시스템은 단순하게 유지한다.

### 7.1 이중 비용 구조

| | 세르파 (AI) | 파티장 (수동) |
|--|--|--|
| 비용 | 운영비 (에피소드당 고정) | 식량 (스텝당 1 소모) |
| 사망 리스크 | 없음 (운영비에 포함) | 있음 (게임 오버) |
| 관리 포인트 | "누구를 보낼까, 몇 번 보낼까" | "식량 얼마나 살까, 언제 돌아갈까" |
| 학습 허들 | RL 알고리즘 이해 (이것만으로 충분) | 던전 서바이벌 (직관적) |

### 7.2 세르파 운영비

세르파를 던전에 보낼 때 **에피소드당 고정 운영비**를 지불한다.
식량, 귀환, 부활 비용이 전부 포함. 스텝별 비용 추적 없음.

```
Q군 → Lv.5 던전 (에피소드 1회):
  운영비: 50G
  → 지불 → Q군이 갔다 옴 → 결과만 확인
  → 죽든 살든 50G. 추가 비용 없음.
```

- **고용 = 1회 언락** (고정비). 이후 추가 고용비 없음.
- **운영비 = 에피소드마다 지불.** 던전 난이도에 따라 증가.

#### Q군의 진짜 약점

Q군은 돈이 아니라 **효율이 문제**:

```
Q군 쌩 학습 (에피소드 200회): 200 × 50G = 10,000G  💸
다이나 (에피소드 30회):        30 × 80G =  2,400G
파티장 시범 후 Q군 (50회):     50 × 50G =  2,500G
```

- Q군은 운영비 자체는 싸지만 에피소드를 많이 돌려야 함 → 총 비용 높음
- 일정 규모 이상 던전은 **수렴 자체가 안 됨** → 돈 문제가 아니라 능력의 벽
- 파티장이 시범을 보여주면 훈련 횟수 감소 → 수동 플레이의 경제적 가치

#### 무료 3인조의 한계 (모델-프리)

Q군, 사르사, 몬테는 무료지만 **지도를 활용하지 못한다** (모델-프리 알고리즘).
직접 가보고, 맞아보고, 그 경험에서만 배운다.

| 세르파 | 지도 활용 | 이유 |
|--------|:--------:|------|
| Q군, 사르사, 몬테 | ✗ | 모델-프리. 경험으로만 학습 |
| **다이나, 스위퍼** | **✓** | 모델 기반. 지도 = 학습 부스트 |
| 나머지 유료 세르파 | ✗ | 모델-프리지만 고급 기법으로 효율적 |

유료 세르파의 가치 = 적은 에피소드로 학습하거나, 지도를 활용하거나, 어려운 던전을 풀 수 있는 능력.

### 7.3 파티장 식량제

파티장이 직접 탐사할 때만 식량 시스템이 적용된다. (섹션 5 참고)

- 식량 구매 → 탐사 → 출구 포털(편도) 또는 입구 귀환(왕복)
- 남은 식량은 전량 소진 (환불 없음)
- 식량 고갈 시 사망 → 게임 오버
- 긴급 탈출 아이템으로 보험 가능

### 7.4 전략적 비대칭

```
전략 A: Q군 브루트포스
  에피소드 200회 × 50G = 10,000G
  안전하지만 느리고 비쌈

전략 B: 파티장 수동 시범 + 소량 훈련
  식량 50개 = 50G (수동 탐사)
  에피소드 50회 × 50G = 2,500G
  합계: 2,550G — 대신 죽으면 끝

전략 C: 다이나 투입
  에피소드 30회 × 80G = 2,400G
  안전하고 빠르지만 고용비가 비쌌음
```

**수동 플레이의 가치 = 돈 절약 + 기록 절약. 대신 죽으면 끝.**

---

## 8. 던전 경제

### 8.1 수입

| 소스 | 금액 | 비고 |
|------|------|------|
| 던전 클리어 보수 | 난이도 비례 | 의뢰 완료금 |
| 지도 판매 | 지도 가치의 1/10 | 즉시 입금 + 낮은 의뢰비 무한 파밍 |
| 안내 의뢰 (독점) | 높은 의뢰비 | 지도 보유 시 N회, 이후 누출로 단가 하락 |
| 안내 의뢰 (일반) | 낮은 의뢰비 | 지도 누출 후 또는 판매 후, 무한 |
| 던전 보물 | 던전별 1회 | 보물칸 밟고 클리어 시 회수 |

### 8.2 지도 판매 vs 안내 의뢰

던전 클리어 후 **지도를 어떻게 할지** 선택한다.

```
던전 클리어!
  ├─ [지도 판매] → 즉시 지도 가치의 1/10 골드 + 낮은 의뢰비로 무한 파밍
  │
  └─ [지도 보유] → 높은 의뢰비로 N회 파밍 → 누출 후 낮은 의뢰비로 무한 파밍
```

#### 지도 판매 (즉시 현금화)

길드가 지도를 **헐값에 사간다.** 세르파 지도 따위 이 정도면 후한 거라고.

- 지도 가치 = 독점 안내 의뢰 총 보수
- 판매가 = **지도 가치의 1/10** (길드 착취)
- 즉시 입금 + **낮은 의뢰비로 무한 파밍** 가능

```
길드 직원: "지도 매입가는 150G입니다. 세르파 지도치고는 후하죠."
(실제 가치: 1,500G)

→ 이후 일반 안내 의뢰 해금 (낮은 의뢰비, 무한)
```

#### 안내 의뢰 — 독점 (지도 보유 시)

지도를 보유한 채 학습 완료 세르파를 배치 → **독점 안내**로 높은 수입.

```
Lv.5 독점 안내 의뢰:
  세르파: Q군 (학습 완료)
  잔여 독점 의뢰: 5회
  식량 비용: 8스텝 × 1회 = 8G
  의뢰 보수: 30G × 1회 = 30G (독점 프리미엄)
  ────────────
  순이익: +22G/회
```

#### 안내 의뢰 — 일반 (누출 후 또는 판매 후)

지도가 시장에 퍼진 뒤에도 학습된 세르파가 있으면 안내는 가능.
다만 경쟁이 생겨서 **단가가 크게 하락**.

```
Lv.5 일반 안내 의뢰:
  세르파: Q군 (학습 완료)
  잔여 의뢰: 무한
  식량 비용: 8스텝 × 1회 = 8G
  의뢰 보수: 10G × 1회 = 10G (경쟁 단가)
  ────────────
  순이익: +2G/회
  ※ 이 스텝도 총 기록에 포함됨
```

- 학습 잘 된 세르파 = 적은 스텝 = 높은 순이익
- 민첩 높으면 빨리 돌아옴
- **파밍도 기록에 포함** → 과도한 파밍은 기록에 불리
- 일반 의뢰는 순이익이 낮아서 **주력 수입원은 안 됨** — 용돈벌이 수준

#### 독점 안내 의뢰 횟수 (던전 난이도별)

| 구간 | 던전 레벨 | 독점 의뢰 횟수 | 이유 |
|------|:--------:|:------------:|------|
| 초반 | Lv.1~5 | 3~5회 | 쉬운 길, 금방 퍼짐 |
| 중반 | Lv.6~20 | 7~10회 | 적당히 복잡 |
| 후반 | Lv.21~31 | 12~15회 | 복잡한 던전, 지도 가치 오래 유지 |

#### 지도 누출 이벤트

독점 의뢰가 소진되면 지도가 시장에 퍼지고, 일반 의뢰로 전환된다.

```
[독점 잔여 1회]
길드 직원: "...솔직히 말하면, 슬슬 다른 루트로 지도가 돌고 있습니다."

[독점 소진]
길드 직원: "독점 안내는 끝입니다. 지도가 시장에 퍼졌거든요."
길드 직원: "일반 안내 의뢰는 계속 받을 수 있습니다. 단가는... 뭐, 아시죠."
```

#### 전략적 선택

| 상황 | 추천 |
|------|------|
| 당장 부활비/식량이 급함 | 지도 판매 (즉시 현금 + 일반 파밍) |
| 여유 있고 수익 극대화 | 지도 보유 (독점 고수익 N회 + 일반 파밍) |
| 기록 줄이기 플레이 | 지도 판매 + 파밍 최소화 (스텝 절약) |

### 8.3 던전 보물

던전에 보물이 **있을 수도, 없을 수도** 있다. 있다면 1회성 수집.

#### 규칙

| 항목 | 설명 |
|------|------|
| 존재 | 던전마다 보물이 있을 수도, 없을 수도 있음 |
| 배치 | 고정 초기 위치 (있는 경우) |
| 획득 | 보물칸 밟으면 자동 획득 (RL 보상 없음, 소지만) |
| 회수 | **보물 소지 상태로 탈출 시 정산** (출구 도달 또는 입구 귀환) |
| 실패 | 보물 소지 중 사망/식량 고갈 → 보물 못 가져옴, **위치 변경** |
| 소멸 | 한번 회수하면 해당 던전 보물 영구 소멸 |
| 훈련/클리어 구분 | **없음** — 어떤 에피소드든 탈출 성공하면 회수 |

#### 입구 귀환 (탈출)

파티장과 세르파 모두 **입구로 돌아가서 귀환**할 수 있다.
던전을 클리어하지 않아도 살아서 돌아오면 보물은 회수.

```
탐사 중 선택:
  ├─ 출구 도달 → 던전 클리어 + 보물 회수 (있으면)
  └─ 입구 귀환 → 클리어 안 됨, 보물만 회수 (있으면)
```

- **파티장**: 위험하면 돌아가는 게 현명 (사망 = 게임 오버)
- **세르파**: 출구까지 가는 게 목표지만, 귀환도 가능한 행위

#### 흐름

```
던전 진입 (보물 있는 경우)
  ├─ 에피소드 47: 보물칸 밟음 → 식량 고갈 → 실패 → 위치 변경
  ├─ 에피소드 48: 보물칸 안 밟음 → 실패
  ├─ 에피소드 63: 보물칸 밟음 → 출구 도달! → 클리어 + 보물 회수!
  ├─ (또는): 보물칸 밟음 → 입구 귀환 → 보물만 회수 (클리어 안 됨)
  └─ 이후: 보물 없음. 순수 학습/클리어만

던전 진입 (보물 없는 경우)
  └─ 보물 없음. 클리어만 목표.
```

#### 설계 의도

- 보물칸에 RL 보상을 주지 않음 → **알고리즘 행동에 영향 없음**
- 게임 레이어에서만 처리 (기존 알고리즘 코드 변경 없음)
- 보물 유무가 불확실 → 탐사의 부가 목표 (메인은 항상 클리어)
- 입구 귀환 = "보물만 먹고 빠지기" 전략 가능 — 리스크 관리
- 파티장이 직접 가서 노리는 것도 가능 — 사망 리스크 vs 공짜 수입

### 8.4 지출

| 용도 | 비용 | 비고 |
|------|------|------|
| 세르파 운영비 | 에피소드당 고정 | 식량+귀환+부활 전부 포함 |
| 파티장 식량 | 1G/개 | 수동 탐사 전용 |
| 세르파 고용 | 200~2,000G | 1회 언락 (무료 3인조 제외) |
| 스탯 업그레이드 | 단계별 증가 | 근력, 민첩, 체력 |
| 정보 구매 | 50~500G | 던전 힌트 |
| 긴급 탈출 아이템 | 가변 | 파티장 보험 |
| 계약 용병 | 일회성 | 방어력 부스트, 함정 무효 등 |

### 8.5 답파 기록 & 세르파 할당

#### 답파 = 최단 경로 저장

답파한 던전은 **클리어 시의 경로**가 기록된다. 이후 더 짧은 경로로 클리어하면 갱신.

```
Lv.5 답파 기록:
  최초 클리어: Q군 — 87스텝
  현재 파밍 경로: 87스텝/회

  → 사르사 투입 → 클리어: 52스텝 → 파밍 경로 갱신!
  → 다이나 투입 → 클리어: 34스텝 → 파밍 경로 갱신!
  → 파티장 직접 → 클리어: 28스텝 → 파밍 경로 갱신!
```

- 파밍 효율 = 최단 클리어 기록에 직결
- 같은 던전에 다른 세르파 투입 → **경로 최적화 투자**
- 파티장 수동 클리어로 기록 갱신 가능 → 리스크 vs 효율

#### 파밍 = RL 안 씀

답파된 던전의 파밍은 **저장된 최적 경로를 따라감.** 알고리즘 관계없이 누구든 투입 가능.

| | 새 던전 (미답파) | 클리어 던전 (답파) |
|--|--|--|
| 핵심 | **RL 학습** (게임의 본체) | **경제 활동** (파밍) |
| 세르파 역할 | 각자 알고리즘으로 탐색 | 최적 경로 따라감 (알고리즘 무관) |
| 비용 | 에피소드당 운영비 | 파밍 비용 (경로 스텝 기반) |

알고리즘 간 Q-table/정책 공유가 기술적으로 불가능한 문제를 깔끔하게 우회:
답파 전에는 각자 독립 학습, 답파 후에는 게임이 경로를 알고 있으므로 공유 불필요.

#### 근력 제한

파밍 경로 스텝 > 세르파 근력(식량 적재량)이면 **파밍 투입 불가.**

```
Lv.15 최단 경로: 120스텝

  Q군 Lv.1  (근력 100): ✗ 투입 불가
  Q군 Lv.3  (근력 160): ✓ 파밍 가능
  몬테 Lv.2  (근력 140): ✓ 파밍 가능
  다이나 Lv.3 (근력 80):  ✗ 투입 불가
```

- **경로를 줄이면** → 더 많은 세르파 파밍 가능
- **근력 올리면** → 긴 경로도 파밍 가능
- **몬테** (근력 +40/Lv): 타고난 짐꾼, 장거리 파밍 전문
- **다이나** (근력 +10/Lv): 답파 전문, 파밍 부적합

#### 세르파 할당

세르파는 **답파 또는 파밍 중 하나에만 배치** 가능.

```
보유 세르파: Q군, 사르사, 다이나

  파밍 배치:               답파 가용:
  ├─ Q군 → Lv.3 파밍       사르사, 다이나
  └─ 사르사 → Lv.5 파밍    다이나만 남음

  → 다음 던전에 다이나 하나로 도전해야 함
```

- 파밍 인력 부족 → 돈 벌 놈이 필요 → **고용 동기**
- 답파 인력 부족 → 공략할 놈이 필요 → **고용 동기**
- "Q군 파밍 빼서 다음 던전 넣을까?" — 수입 vs 진행의 선택

세르파들은 경쟁자가 아니라 **분업 관계**:
- Q군: 초반 답파 + 클리어 던전 파밍 일꾼 (무료, 근력 적당)
- 사르사: 위험 던전 답파 (겁쟁이라 함정/몬스터 회피)
- 몬테: 장거리 파밍 전문 (근력 왕)
- 다이나: 새 던전 답파 전문 (효율적 학습, 파밍은 부적합)

---

## 9. 로그라이크 구조

### 9.1 런(Run) = 파티장의 한 생애

```
[런 시작]
  ├─ 소지금: 500G
  ├─ 세르파: Q군, 사르사, 몬테 (무료 3인조)
  ├─ 세르파 학습(Q-table): ★ 이전 런에서 유지 ★
  │
  ├─ 던전 답파
  │    ├─ 세르파 파견 (안전, 운영비)
  │    └─ 파티장 직접 탐사 (위험, 식량만)
  │
  └─ [파티장 사망 → 게임 오버]
       리셋되는 것:
         - 골드 → 0
         - 유료 세르파 → 재고용 필요
         - 던전 해금 → 초기화
         - 답파 기록 → 초기화
         - 세르파 스탯 → 초기화
       유지되는 것:
         - ★ 전 세르파 Q-table ★
         - 무료 3인조 (Q군, 사르사, 몬테)
```

### 9.2 런이 쌓이면

| 런 | 상황 |
|:--:|------|
| 1 | 무료 3인조로 Lv.1~5. 직접 정찰하다 Lv.6에서 사망 |
| 2 | 초반 즉클 (Q-table 남아있음). 번 돈으로 트레이서 고용. Lv.10까지 |
| 3 | 초반 즉클 → 다이나 고용 → Lv.15까지 |
| 5 | 초반을 세르파가 자동 쓸어줌. 파밍 배치 + 답파 분업 |
| 10 | 중반까지 자동화. 후반 도전 중 |

**초반 런: 직접 뛰어다니는 서바이벌**
**후반 런: 뒤에서 지시하는 매니지먼트**

---

## 10. 기록 시스템

### 10.1 총 스텝 카운터 (숨김)

플레이 중 유저 모르게 **모든 스텝**을 누적.
수동 탐사 + 세르파 훈련 + 클리어 + 파밍 전부 포함.

### 10.2 엔딩에서 공개

```
━━━ 축하합니다! 전 던전 답파 완료! ━━━

  총 스텝: 247,832
  사망 횟수: 7회
  사용 세르파: 8명
  최다 활약: 다이나 (11개 던전 클리어)

  "이 기록을 줄일 수 있을까요?"
  [New Game+]
```

### 10.3 2회차: 기록 줄이기

세르파 학습이 남아있으니 런마다 효율 상승:
```
1회차: 247,832스텝
2회차: 152,401스텝 (세르파 학습됨)
3회차:  89,230스텝 (최적 운영)
```

기록 검증/랭킹은 서버 도입 시점에서 설계 (클라이언트만으로는 조작 방지 불가).

---

## 11. 챕터 구성

| 챕터 | 이름 | 던전 | 합류/고용 가능 세르파 | 핵심 RL 개념 |
|:----:|------|------|-------------------|-------------|
| 1 | 첫 발걸음 | Lv.1~3 | Q군 (스타터) | Q-Learning, 보상, 정책 |
| 2 | 위험한 길 | Lv.4~7 | 사르사 | On-policy, 안전 경로 |
| 3 | 넓은 세계 | Lv.8~12 | 몬테, 트레이서, 다이나 | MC, 적격 흔적, 모델 기반 |
| 4 | 직감과 비평 | Lv.13~17 | 그래디, 크리틱 | 정책 경사법, Actor-Critic |
| 5 | 합의의 힘 | Lv.18~25 | QV군, 아클라, 앙상블 | 앙상블 |
| 6 | 불확실한 바닥 | Lv.26~28 | 에크사, 더블Q | 확률적 환경, 과대추정 |
| 7 | 심연 | Lv.29~31 | 트리백, 스위퍼 | 대규모, 절차적 던전 |

### 세르파 합류 방식
- **스토리 합류**: 챕터 진행 중 특정 던전에서 만남 (무료)
- **조기 고용**: 아직 만나지 않은 세르파를 골드로 미리 고용 가능

### 정보 힌트 연동
길드에서 파는 정보가 세르파 고용을 유도:
- "신중한 녀석이 유리하다" → 사르사
- "상상력이 필요하다" → 다이나
- "끝까지 가봐야 안다" → 몬테

---

## 12. Act 2: 던전 마스터 (엔딩 후)

```
┌─────────────────────────────────────────────┐
│        vs AI 던전 마스터 "다크로드"            │
│                                              │
│  [내 던전]                [적 던전]           │
│  ■■■□□ 방어력            ■■■■□ 방어력        │
│  적 세르파 3마리 침입 중   내 세르파 2마리 공략 중│
│                                              │
│  ⏱ 제한시간: 5:00                            │
│  적 세르파가 내 던전을 뚫기 전에               │
│  적 던전을 먼저 클리어하라!                    │
└─────────────────────────────────────────────┘
```

- 던전 에디터로 자기 던전 설계
- AI가 못 풀게 만드는 구조가 곧 방어력
- 공격과 방어를 동시에 — 자원 분배 전략
- Act 1에서 "AI가 어떻게 길을 찾는지" 배웠으니, "못 찾게 만드는 법"을 응용

---

## 13. 핵심 설계 원칙

### "이 게임 뭐하는 건데?"
> 멍청한 세르파들한테 던전 길 찾기를 시키는 게임.
> 직접 가면 싸지만 죽으면 끝. 세르파 보내면 안전하지만 비쌈.
> 세르파들은 죽어도 배운 건 기억함. 죽을수록 똑똑해짐.
> 전부 깨면 네가 던전 주인.

### "왜 세르파가 멍청한데?"
좋게 말해서 세르파. 실상은 모험가 대신 몸빵 뛰는 놈들.
목숨이 아까운 사람은 이 일 안 한다.
대신 죽을 때마다 뭔가를 배우는 게 이 놈들의 유일한 장점.

### "왜 여러 명 필요한데?"
각자 멍청한 방식이 다르다.
Q군은 직진하다 죽고, 사르사는 무서워서 안 가고, 몬테는 끝까지 가봐야 판단한다.
어떤 던전에서는 Q군의 직진이 맞고, 어떤 던전에서는 사르사의 겁이 맞다.
"적재적소"가 이 게임의 전략.

---

## 14. 기존 코드 영향도

| 기존 시스템 | 변경 | 비고 |
|-----------|:----:|------|
| 15개 알고리즘 | 없음 | 세르파로 래핑 |
| 31개 던전 | 없음 | 챕터 메타데이터 추가 |
| Q-Table 저장 | 없음 | 런 리셋에도 유지 (핵심) |
| 골드 이코노미 | 리디자인 | 식량, 고용, 파밍 체계 |
| 전장의 안개 | 활용 | 정찰/지도 시스템 |
| 던전 에디터 | 그대로 | Act 2에서 해금 |
| 수동 모드 | 개조 | 파티장 탐사 (사망=게임오버) |
| LfD | 활용 | 수동 탐사 → 학습 자료 |

**알고리즘 코드는 일절 건드리지 않는다.** 게임 레이어만 위에 씌운다.

---

## 15. 하지 않는 것

- ❌ 알고리즘 성능에 영향 주는 강화 (스탯은 운영만)
- ❌ 세르파가 OP가 되는 성장 (몸빵이 영웅이 되면 안 됨)
- ❌ 새 알고리즘/던전 추가 (15개, 31개로 충분)
- ❌ 전투 시스템 (맞으면 피 깎이고 끝)
- ❌ 서버/PvP (Act 1 이후)
- ❌ 과금

---

## 16. 구현 우선순위 (Act 1)

### Phase A: 로그라이크 뼈대
1. 런 시스템 (시작/리셋/Q-table 계승)
2. 파티장 사망 = 게임 오버
3. 세르파 잠금/해금 (Q군만 시작)
4. 식량 = 스텝 비용

### Phase B: 경제
5. 골드 리디자인 (식량 구매, 파밍 수입)
6. 세르파 고용/부활 비용
7. 세르파 스탯 & 업그레이드
8. 정보 구매 시스템 (던전 힌트)

### Phase C: 연출
9. 모험가 길드 UI (의뢰 수령, 정보 구매)
10. 챕터 구조 & 세르파 합류 이벤트
11. 결과 화면 & 캐릭터 대사

### Phase D: 기록 & 2회차
12. 총 스텝 카운터 (숨김)
13. 엔딩 화면 + 기록 공개
14. New Game+ / 기록 도전

### Phase E: Act 2
15. 던전 에디터 해금
16. AI 던전 마스터 공방전

---

*Document Version: 3.0*
*Last Updated: 2026-02-21*
